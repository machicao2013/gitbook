tcp相关的算法
================

## tcp相关的算法 ##

### 滑动窗口 ###

滑动窗口是TCP使用的一种流量控制的方法，在TCP中采用滑动窗口来进行传输控制时，滑动窗口的大小意味着接收方的有多大的缓冲来接收数据。TCP连接上的双方都会通知对方自己的接收窗口大小。而对方的接收窗口大小就是自己的发送窗口大小。*发送窗口是一个时刻变化的值，随着ACK的到达会变大，随着发出新的数据包会变小。当然，最大也只能到三次握手时对方通告的窗口大小。*

## 慢启动 ##

由于两台主机间的网络可能很复杂，通过广域网时，中间的路由器转发能力可能是瓶颈。也就是说，如果一方简单的按照另一方主机三次握手时通告的滑动窗口大小来发送数据的话，可能会使得网络上转发路由器性能雪上加霜，最终丢失更多的分组，这时，各个操作系统内核都会对TCP的发送阶段加入慢启动和拥塞避免算法。

慢启动算法，就是对方通告的窗口大小只表示对方接收TCP分组的能力，不表示中间网络能够处理分组的能力。所以，发送发请悠着点发，确保网络非常通畅后，在按照对方通告窗口来敞开发。

拥塞窗口就是cwnd,它用来帮助慢启动的实现。连接刚建立时，拥塞窗口的大小远小于发送窗口，它实际上是一个MSS。每收到一个ACK，拥塞窗口扩大一个MSS大小，当然，拥塞窗口最大只能到对方通告的接收窗口大小。当然，为了避免指数式增长，拥塞窗口大小的增长会更慢一些，是线性的平滑的增长。

所以在tcp发送消息时，还会检查拥塞窗口，飞行中的报文数要小于拥塞窗口个数，而发送数据的长度也要小于拥塞窗口的长度。


## Nagle算法 ##

Nagle算法的初衷是这样的：应用进程调用发送方法时，可能每次只发送小块数据，造成这台机器发送了许多小的TCP报文，对于整个网络的执行效率来说，小的TCP报文会增加网络拥塞的可能，因此，如果有可能，应该将相邻的TCP报文合并成一个较大的TCP报文(当然还是小于MSS的)发送。

Nagle算法要求一个TCP连接上最多只能有一个发送出去还没有被确认的小分组，在该分组的确认到达之前不能发送其他的小分组。


